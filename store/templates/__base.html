{% extends "base.html" %}
{% load user_extras %}
{% load static %}


{% block content %}
    <header class="bg-white sticky z-50 top-0 border-primary-light-green">
      <div class="bg-primary-green text-white h-[32px] w-full flex justify-between items-center px-[96px] py-1">
        
        <!-- Left social icons -->
        <div class="socials flex flex-row gap-2 items-center">
          <span class="badge-label">Follow Us:</span>
          <a href="https://facebook.com" target="_blank">
            <img src="{% static 'assets/facebook.png' %}" alt="Facebook">
          </a>
          <a href="https://twitter.com" target="_blank">
            <img src="{% static 'assets/x-twitter.png' %}" alt="Twitter">
          </a>
          <a href="https://instagram.com" target="_blank">
            <img src="{% static 'assets/instagram.png' %}" alt="Instagram">
          </a>
        </div>

        <!-- Right contact info -->
        <ul class="flex flex-row gap-4 items-center">
          <li class="flex items-center gap-1">
            <img src="{% static 'assets/search.png' %}" alt="search">
          </li>
          <li class="flex items-center gap-1">
            <img src="{% static 'assets/call.png' %}" alt="call">
            <span class="badge-label">Call: 0742080330</span>
          </li>
          <li class="flex items-center gap-1">
            <img src="{% static 'assets/email.png' %}" alt="Email">
            <span class="badge-label">Email: info@ecopia.com</span>
          </li>
        </ul>
      </div>
      <div class= "border-b border-gray-200 text-primary-green w-full flex justify-between items-center px-[96px] py-4">
          <a href="/" target="">
            <img src="{% static 'assets/logo.png' %}" alt="logo" class="h-[56px]">
          </a>
          {% comment %} <nav class="shadow-m">
              <div class="flex justify-between">
                <ul class="flex space-x-8">
                  <li > 
                    <a href="{% url 'products:products' %}"
                        class="rounded-sm inline-flex items-center px-3 py-1 text-m font-normal text-gray-500 {% if not category %}bg-primary-green text-white{% else %}hover:bg-gray-100{% endif %}"
                    >
                        All
                    </a>
                  </li>
                  {% for cat in categories %}
                  <li>
                    <a href="{% url 'products:product_list_by_category' cat.slug%}"
                        class="rounded-sm inline-flex items-center px-3 py-1 text-m font-normal text-gray-500 {% if category == cat %}bg-primary-green text-white{% else %}hover:bg-gray-100{% endif %}"
                    >
                      {{ cat.name }}
                    </a>
                  </li>
                  {% endfor %}
                </ul>
              </div>
          </nav> {% endcomment %}
          <div class="flex items-center justify-between py-2 gap-x-12">
              <div class="flex items-center justify-center">
                <div class="flex items-center bg-gray-50 px-3 rounded-md py-1 w-full max-w-lg">
                  <img src="{% static 'assets/search-g.png' %}" alt="search">
                  <input
                    type="text"
                    placeholder="What Are You Looking For?"
                    class="flex-grow px-4 py-2 bg-transparent border-none focus:outline-none focus:ring-0"
                  />
                  <div class='w-10 flex justify-center items-center'>
                    {% comment %} <button
                      class="mr-6 text-gray-500 focus:outline-none"
                    >
                      X
                    </button> {% endcomment %}
                  </div>
                </div>
              </div>
              <!-- Right Actions -->
              <div class="flex items-center justify-between gap-x-4">
                  <!-- Cart Icon -->
                  <a href="{% url 'cart' %}" target="_blank">
                    <svg stroke="currentColor" fill="currentColor" stroke-width="0" version="1.2" baseProfile="tiny" viewBox="0 0 24 24" class="text-emerald-800 ml-4 __web-inspector-hide-shortcut__" height="24" width="24" xmlns="http://www.w3.org/2000/svg"><g><path d="M20.756 5.345c-.191-.219-.466-.345-.756-.345h-13.819l-.195-1.164c-.08-.482-.497-.836-.986-.836h-2.25c-.553 0-1 .447-1 1s.447 1 1 1h1.403l1.86 11.164.045.124.054.151.12.179.095.112.193.13.112.065c.116.047.238.075.367.075h11.001c.553 0 1-.447 1-1s-.447-1-1-1h-10.153l-.166-1h11.319c.498 0 .92-.366.99-.858l1-7c.041-.288-.045-.579-.234-.797zm-1.909 1.655l-.285 2h-3.562v-2h3.847zm-4.847 0v2h-3v-2h3zm0 3v2h-3v-2h3zm-4-3v2h-3l-.148.03-.338-2.03h3.486zm-2.986 3h2.986v2h-2.653l-.333-2zm7.986 2v-2h3.418l-.285 2h-3.133z"></path><circle cx="8.5" cy="19.5" r="1.5"></circle><circle cx="17.5" cy="19.5" r="1.5"></circle></g></svg>
                  </a>

                  <!-- Account Button -->
                  <div class="relative inline-block text-left">
                    <!-- Button -->
                  <button id="accountButton"
                    class="inline-flex items-center justify-center text-center gap-1 bg-primary-green text-white px-2 py-2 rounded-lg shadow hover:bg-primary-dark-green transition">
                    
                    <!-- User Icon -->
                    <svg stroke="#FFFFFF" fill="none" stroke-width="2" viewBox="0 0 16 24" 
                        stroke-linecap="round" stroke-linejoin="round"
                        class="text-primary-green" height="15" width="24"
                        xmlns="http://www.w3.org/2000/svg">
                      <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                      <circle cx="12" cy="7" r="4"></circle>
                    </svg>

                    <!-- Account Text -->
                    <span id="accountText" class="self-end text-center mr-2">
                      {% if request.user.is_authenticated %}
                        Hi, {{ request.user.full_name|first_name }}
                      {% else %}
                        Account
                      {% endif %}
                    </span>

                    <!-- Dropdown Icon -->
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" stroke-width="2"
                        viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
                    </svg>
                  </button>


                    <!-- Dropdown Menu -->
                    <div id="dropdownMenu"
                      class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-white z-50">

                      {% if request.user.is_authenticated %}
                        <!-- Logged In State -->
                        <div id="userMenu">
                          <a href="/account" class="block  text-center px-4 py-2 hover:bg-gray-100">My Account</a>
                          <a href="/orders" class="block text-center px-4 py-2 hover:bg-gray-100">Orders</a>
                          <a href="/inbox" class="block px-4 text-center py-2 hover:bg-gray-100">Inbox</a>
                          <a href="/wishlist" class="block px-4 text-center py-2 hover:bg-gray-100">Wishlist</a>
                          <a href="/vouchers" class="block px-4 text-center py-2 hover:bg-gray-100">Vouchers</a>
                          <hr class="border-t border-primary-light-green">
                          <a href="{% url 'logout' %}" class="block text-center px-4 py-2 text-accent rounded-b-lg hover:bg-red-50 font-medium">Logout</a>
                        </div>
                      {% else %}
                        <!-- Logged Out State -->
                        <div id="guestMenu" class="justify-center">
                          <a href="{% url 'login' %}" class="block w-3/4  rounded-lg mx-auto my-2 bg-primary-green text-center px-4 py-2 hover:bg-primary-dark-green text-white font-medium">Login</a>
                          <a href="{% url 'register' %}" class="block text-center px-4 py-2 hover:bg-gray-100">Register</a>
                          <hr class="border-t border-primary-light-green">
                          <a href="/account" class="block text-center px-4 py-2 hover:bg-gray-100">My Account</a>
                          <a href="/orders" class="block text-center px-4 py-2 hover:bg-gray-100">Orders</a>
                          <a href="/wishlist" class="block text-center px-4 py-2 hover:bg-gray-100">Wishlist</a>
                        </div>
                      {% endif %}
                    </div>

                  </div>

              </div>
          </div>

      </div>
      <nav class="bg-white shadow-m px-[96px] py-4">
              <div class="flex justify-between">
                <ul class="flex space-x-8">
                  <li class="{% if category == cat %}
                        border-b-2 border-primary-green
                        {%endif%}
                        "> 
                    <a href="{% url 'products:products' %}"
                        class="rounded-sm inline-flex items-center px-3 py-1 text-m font-normal text-gray-500 
                        {% if not category %}
                        text-primary-green
                        {% else %}
                        hover:text-gray-700
                        {% endif %}"
                    >
                        All
                    </a>
                  </li>
                  {% for cat in categories %}
                  <li class="{% if category == cat %}
                        border-b-2 border-primary-green
                        {%endif%}
                        ">
                    <a href="{% url 'products:product_list_by_category' cat.slug%}"
                        class="rounded-sm inline-flex items-center px-3 py-1 text-m font-normal text-gray-500
                        {% if category == cat %}
                        text-primary-green
                        {% else %}
                        hover:text-gray-700
                        {% endif %}"
                    >
                      {{ cat.name }}
                    </a>
                  </li>
                  {% endfor %}
                </ul>
              </div>
          </nav>
      </header>
    <main>
      {% block main %}
      {% endblock %}
    </main>

    <footer class="bg-accent text-white p-4 text-center">
      <p>&copy; 2025 Ecopia. All rights reserved.</p>
    </footer>
    {% block scripts %}
    <script>
      const button = document.getElementById("accountButton");
      const menu = document.getElementById("dropdownMenu");

      if (button) {
        button.addEventListener("click", () => {
          menu.classList.toggle("hidden");
        });

        // Close when clicking outside
        document.addEventListener("click", (e) => {
          if (!button.contains(e.target) && !menu.contains(e.target)) {
            menu.classList.add("hidden");
          }
        });
      }
    </script>
    {% endblock %}
{% endblock %}
